{% extends 'base.html' %}

{% block title %}
  {{ news_item.title }}::{{ block.super }}
{% endblock %}

{% block sidebar %}
  {% include 'inc/_sidebar.html' %}
{% endblock %}

{% block footer %}
  {% include 'inc/_footer.html' %}
{% endblock %}

{% block header %}
  {% include 'inc/_header.html' %}
{% endblock %}

{% block toolbar%}
    {% include 'inc/_toolbar.html' %}
{% endblock %}

{% load news_tags %}
{% load sidebar_last_news %}
{% load news_widgets %}
{% load alerts %}
{% load project_tags %}
{% block content %}
  <!--begin::Body-->
  <div class="card-body p-lg-20 pb-lg-0">
	  <!--begin::Layout-->
	  <div class="d-flex flex-column flex-xl-row">
		  <!--begin::Content-->
		  <div class="flex-lg-row-fluid me-xl-15">
			  {% if updated_success %}
			  	{% show_alerts request.resolver_match.url_name %}
			  {% endif %}
			  {% if page_type == 'NewsByCategory'%}
			  <h4 class="text-dark mb-7">Категория: {{category_title}}. Количество новостей: {{count}}</h4>
			  {% elif page_type == 'NewsBySaved'%}
			  <h4 class="text-dark mb-7">Новости сохраненные пользователем {{username.first_name}} {{username.last_name}}. Количество новостей: {{count}}</h4>
			  {% elif page_type == 'NewsByLiked'%}
			  <h4 class="text-dark mb-7">Новости понравившиевся пользователю {{username.first_name}} {{username.last_name}}. Количество новостей: {{count}}</h4>
			  {% endif %}
			  <!--begin::Post content-->
				<div class="mb-17">
				{%for news_item in all_news %}
				{% if news_item.is_published == True %}
					<div class="card-body py-9">
					<!--begin::Row-->
						<div class="row gx-9">
							<!--begin::Col-->
							<div class="col-sm-6 mb-10 mb-sm-0">
								<!--begin::Image-->
								{% if news_item.photo %}
								<img src="{{news_item.photo.url}}" class="img-fluid rounded-start">
                                {% else %}
								<img src="https://preview.keenthemes.com/metronic8/demo1/assets/media/stock/1600x800/img-1.jpg" class="img-fluid rounded-start" width="600px">
                                {% endif %}
								<!--end::Image-->
							</div>
							<!--end::Col-->
							<!--begin::Col-->
							<div class="col-sm-6">
								<!--begin::Wrapper-->
								<div class="d-flex flex-column h-100">
									<!--begin::Header-->
									<div class="mb-7">
										<!--begin::Headin-->
										<div class="d-flex flex-stack mb-6">
											<!--begin::Title-->
											<a href="{{ news_item.get_absolute_url }}" class="fw-bolder text-dark mb-4 fs-2 lh-base text-hover-primary">{{news_item.title}}</a>
											<!--end::Title-->
											<span class="badge badge-light-primary flex-shrink-0 align-self-center py-3 px-4 fs-7">{{news_item.category}}</span>
										</div>
										<!--end::Heading-->
										<!--begin::Items-->
										<div class="d-flex align-items-center flex-wrap d-grid gap-2">
											<!--begin::Item-->
											<div class="d-flex align-items-center me-5 me-xl-13">
												<!--begin::Symbol-->
												<div class="symbol symbol-30px symbol-circle me-3">
													{% if news_item.author.profile.photo %}
													<img src="{{news_item.author.profile.photo.url}}" class="" alt="">
													{% else %}
													<span class="symbol-label bg-primary text-inverse-primary fw-bolder">{{news_item.author.first_name|upfirstletter}}</span>
													{% endif %}
												</div>
												<!--end::Symbol-->
												<!--begin::Info-->
												<div class="m-0">
													<span class="fw-semibold text-gray-400 d-block fs-8">Автор статьи</span>
													<a href="{% url 'profile' %}" class="fw-bold text-gray-800 text-hover-primary fs-7">{{news_item.author.first_name}} {{news_item.author.last_name}}</a>
												</div>
												<!--end::Info-->
											</div>
											<!--end::Item-->
											<!--begin::Item-->
											<div class="d-flex align-items-center">
												<!--begin::Symbol-->
												<div class="symbol symbol-30px symbol-circle me-3">
													<span class="symbol-label bg-success">
														<!--begin::Svg Icon | path: icons/duotune/abstract/abs042.svg-->
														<span class="svg-icon svg-icon-5 svg-icon-white">
															<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
																<path d="M18 21.6C16.6 20.4 9.1 20.3 6.3 21.2C5.7 21.4 5.1 21.2 4.7 20.8L2 18C4.2 15.8 10.8 15.1 15.8 15.8C16.2 18.3 17 20.5 18 21.6ZM18.8 2.8C18.4 2.4 17.8 2.20001 17.2 2.40001C14.4 3.30001 6.9 3.2 5.5 2C6.8 3.3 7.4 5.5 7.7 7.7C9 7.9 10.3 8 11.7 8C15.8 8 19.8 7.2 21.5 5.5L18.8 2.8Z" fill="currentColor"></path>
																<path opacity="0.3" d="M21.2 17.3C21.4 17.9 21.2 18.5 20.8 18.9L18 21.6C15.8 19.4 15.1 12.8 15.8 7.8C18.3 7.4 20.4 6.70001 21.5 5.60001C20.4 7.00001 20.2 14.5 21.2 17.3ZM8 11.7C8 9 7.7 4.2 5.5 2L2.8 4.8C2.4 5.2 2.2 5.80001 2.4 6.40001C2.7 7.40001 3.00001 9.2 3.10001 11.7C3.10001 15.5 2.40001 17.6 2.10001 18C3.20001 16.9 5.3 16.2 7.8 15.8C8 14.2 8 12.7 8 11.7Z" fill="currentColor"></path>
															</svg>
														</span>
														<!--end::Svg Icon-->
													</span>
												</div>
												<!--end::Symbol-->
												<!--begin::Info-->
												<div class="m-0">
													<span class="fw-semibold text-gray-400 d-block fs-8">Дата публикации</span>
													<span class="fw-bold text-gray-800 fs-7">{{ news_item.created_at|date:"d.m.Y H:i" }}</span>
												</div>
												<!--end::Info-->
											</div>
											<!--end::Item-->
										</div>
										<!--end::Items-->
									</div>
									<!--end::Header-->
									<!--begin::Body-->
									<div class="mb-6">
										<!--begin::Text-->
										<span class="fw-semibold text-gray-600 fs-6 mb-8 d-block">{{news_item.content|truncatewords:20|striptags}}</span>
										<!--end::Text-->
									</div>
									<!--end::Body-->
									<!--begin::Footer-->
									<div class="d-flex flex-stack mt-auto bd-highlight">
										<!--begin::Actions-->
										<a href="{% url 'delete_new' news_item.id %}" class="text-primary opacity-75-hover fs-6 fw-semibold">Подробнее
										<!--begin::Svg Icon | path: icons/duotune/arrows/arr095.svg-->
										<span class="svg-icon svg-icon-4 svg-icon-gray-800 ms-1">
											<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
												<path opacity="0.3" d="M4.7 17.3V7.7C4.7 6.59543 5.59543 5.7 6.7 5.7H9.8C10.2694 5.7 10.65 5.31944 10.65 4.85C10.65 4.38056 10.2694 4 9.8 4H5C3.89543 4 3 4.89543 3 6V19C3 20.1046 3.89543 21 5 21H18C19.1046 21 20 20.1046 20 19V14.2C20 13.7306 19.6194 13.35 19.15 13.35C18.6806 13.35 18.3 13.7306 18.3 14.2V17.3C18.3 18.4046 17.4046 19.3 16.3 19.3H6.7C5.59543 19.3 4.7 18.4046 4.7 17.3Z" fill="currentColor"></path>
												<rect x="21.9497" y="3.46448" width="13" height="2" rx="1" transform="rotate(135 21.9497 3.46448)" fill="currentColor"></rect>
												<path d="M19.8284 4.97161L19.8284 9.93937C19.8284 10.5252 20.3033 11 20.8891 11C21.4749 11 21.9497 10.5252 21.9497 9.93937L21.9497 3.05029C21.9497 2.498 21.502 2.05028 20.9497 2.05028L14.0607 2.05027C13.4749 2.05027 13 2.52514 13 3.11094C13 3.69673 13.4749 4.17161 14.0607 4.17161L19.0284 4.17161C19.4702 4.17161 19.8284 4.52978 19.8284 4.97161Z" fill="currentColor"></path>
											</svg>
										</span>
										<!--end::Svg Icon-->
										</a>
										<a href="{% url 'delete_new' news_item.id %}" class="text-danger opacity-75-hover fs-6 fw-semibold">Удалить
										<!--begin::Svg Icon | path: icons/duotune/arrows/arr095.svg-->
										<span class="svg-icon svg-icon-4 svg-icon-gray-800 ms-1">
											<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
												<path opacity="0.3" d="M4.7 17.3V7.7C4.7 6.59543 5.59543 5.7 6.7 5.7H9.8C10.2694 5.7 10.65 5.31944 10.65 4.85C10.65 4.38056 10.2694 4 9.8 4H5C3.89543 4 3 4.89543 3 6V19C3 20.1046 3.89543 21 5 21H18C19.1046 21 20 20.1046 20 19V14.2C20 13.7306 19.6194 13.35 19.15 13.35C18.6806 13.35 18.3 13.7306 18.3 14.2V17.3C18.3 18.4046 17.4046 19.3 16.3 19.3H6.7C5.59543 19.3 4.7 18.4046 4.7 17.3Z" fill="currentColor"></path>
												<rect x="21.9497" y="3.46448" width="13" height="2" rx="1" transform="rotate(135 21.9497 3.46448)" fill="currentColor"></rect>
												<path d="M19.8284 4.97161L19.8284 9.93937C19.8284 10.5252 20.3033 11 20.8891 11C21.4749 11 21.9497 10.5252 21.9497 9.93937L21.9497 3.05029C21.9497 2.498 21.502 2.05028 20.9497 2.05028L14.0607 2.05027C13.4749 2.05027 13 2.52514 13 3.11094C13 3.69673 13.4749 4.17161 14.0607 4.17161L19.0284 4.17161C19.4702 4.17161 19.8284 4.52978 19.8284 4.97161Z" fill="currentColor"></path>
											</svg>
										</span>
										<!--end::Svg Icon-->
										</a>
										<!--end::Actions-->
									</div>
									<!--end::Footer-->
								</div>
								<!--end::Wrapper-->
							</div>
							<!--end::Col-->
						</div>
					<!--end::Row-->
					</div>
			  {% else %}
				Новостей нет
			  {% endif %}
			  {% endfor %}

              <nav>
                  <ul class="pagination justify-content-center">
                      {% if page_obj.has_previous %}
                        <li class="page-item"><a class="page-link success" href="?page={{page_obj.previous_page_number}}">Предыдущая</a></li>
                      {% endif %}

                      {% for p in page_obj.paginator.page_range %}

                          {% if page_obj.number == p %}
                            <li class="page-item"><a class="page-link success active" href="?page={{p}}">{{p}}</a></li>
                          {% elif p > page_obj.number|add:-3 and p < page_obj.number|add:3 %}
                            <li class="page-item"><a class="page-link success" href="?page={{p}}">{{p}}</a></li>
                          {% endif %}

                      {% endfor %}

                      {% if page_obj.has_next %}
                        <li class="page-item"><a class="page-link success" href="?page={{page_obj.next_page_number}}">Следующая</a></li>
                      {% endif %}
                  </ul>
              </nav>
			  </div>
			  <!--end::Post content-->
		  </div>
		  <!--end::Content-->
		  <!--begin::Sidebar-->
		  <div class="flex-column flex-lg-row-auto w-100 w-xl-300px mb-10">
              <!--begin::Search blog-->
              <div class="mb-16">
                  <h4 class="text-dark mb-7">Поиск</h4>
                  <!--begin::Input group-->
                  <div class="position-relative">
                      <!--begin::Svg Icon | path: icons/duotune/general/gen021.svg-->
                      <span class="svg-icon svg-icon-3 svg-icon-gray-500 position-absolute top-50 translate-middle ms-6">
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor"></rect>
                              <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor"></path>
                          </svg>
                      </span>
                      <!--end::Svg Icon-->
                      <input type="text" class="form-control form-control-solid ps-10" name="search" value="" placeholder="Поиск...">
                  </div>
                  <!--end::Input group-->
              </div>
              <!--end::Search blog-->
              <!--begin::Catigories-->
              <div class="mb-16">
                  <h4 class="text-dark mb-7">Категории</h4>
                  {% show_sidebar_categories %}
              </div>
              <!--end::Catigories-->

              <!--begin::Recent posts-->
              <div class="m-0">
                  <h4 class="text-dark mb-7">Последние новости</h4>
                  {% show_sidebar_news %}
              </div>
              <!--end::Recent posts-->
          </div>
		  <!--end::Sidebar-->
	  </div>
	  <!--end::Layout-->

  </div>
  <!--end::Body-->
{% endblock %}
